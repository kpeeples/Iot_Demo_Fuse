{
   "kind": "Template",
   "apiVersion": "v1",
   "metadata": {
     "name": "iot-demo",
     "annotations": {
        "description": "An example IoT Application",
        "tags": "instant-app",
        "iconClass": "icon-php"
     }
   },
   "labels": {
      "application": "iotcontrollerreceiver",
      "createdBy": "psteiner",
      "template": "iotcontrollerreceiver"
   },
   "objects": [
     {
        "kind": "Service",
        "apiVersion": "v1",
        "metadata": {
           "name": "iotcontrollerreceiver",
           "labels": {
              "application": "iotcontrollerreceiver"
           }
        },
        "spec": {
           "ports": [
              {
                 "name": "receiver-http",
                 "port": 8181,
                 "targetPort": 8181
              },
              {
                 "name": "receiver-jms",
                 "protocol": "TCP",
                 "port": 61616,
                 "targetPort": 61616,
                 "nodePort": 30061
              }
           ],
           "selector": {
              "deploymentConfig": "iotcontrollerreceiver"
           },
           "type": "NodePort"
        }
     },
     {
        "kind": "Route",
        "apiVersion": "v1",
        "metadata": {
           "name": "iotcontrollerreceiver",
           "labels": {
              "application": "iotcontrollerreceiver"
           },
           "annotations": {
              "description": "Route for IoT Controller Receiver"
           }
        },
        "spec": {
           "host": "iot-demo.cloudapps.example.com",
           "to": {
              "kind": "Service",
              "name": "iotcontrollerreceiver"
           }
        }
     },
     {
        "kind": "DeploymentConfig",
        "apiVersion": "v1",
        "metadata": {
           "name": "iotcontrollerreceiver",
           "labels": {
              "deploymentConfig": "iotcontrollerreceiver",
              "application": "iotcontrollerreceiver"
           }
        },
        "spec": {
           "replicas": 1,
           "selector": {
              "deploymentConfig": "iotcontrollerreceiver"
           },
           "strategy": {
              "type": "Recreate"
           },
           "template": {
              "metadata": {
                 "labels": {
                    "deploymentConfig": "iotcontrollerreceiver",
                    "application": "iotcontrollerreceiver"
                 },
                 "name": "iotcontrollerreceiver"
              },
              "spec": {
                 "containers": [
                    {
                       "name": "iotcontrollerreceiver",
                       "image": "iotcontrollerreceiver",
                       "imagePullPolicy": "IfNotPresent",
                       "env": [
                          {
                             "name": "OPENSHIFT_DNS_PING_SERVICE_NAME",
                             "value": "mlbparks-ping"
                          }
                       ],
                       "ports": [
                          {
                             "name": "receiver-http",
                             "containerPort": 8181,
                             "protocol": "TCP"
                          },
                          {
                             "name": "receiver-jms",
                             "containerPort": 61616,
                             "protocol": "TCP"
                          }
                       ]
                    },
                    {
                       "name": "iotcontrollercep",
                       "image": "iotcontrollercep",
                       "imagePullPolicy": "IfNotPresent"
                    }
                 ],
                 "restartPolicy": "Always",
                 "dnsPolicy": "ClusterFirst"
              }
           },
           "triggers": [
              {
                 "type": "ImageChange",
                 "imageChangeParams": {
                    "automatic": true,
                    "containerNames": [
                       "iotcontrollerreceiver"
                    ],
                    "from": {
                       "kind": "ImageStreamTag",
                       "name": "iotcontrollerreceiver:latest"
                    }
                 }
              },
              {
                 "type": "ImageChange",
                 "imageChangeParams": {
                    "automatic": true,
                    "containerNames": [
                       "iotcontrollercep"
                    ],
                    "from": {
                       "kind": "ImageStreamTag",
                       "name": "iotcontrollercep:latest"
                    }
                 }
              },
              {
                 "type": "ConfigChange"
              }
           ]
        }
     }
  ]
}
